var TNT=function(e){"use strict";function t(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function r(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}const n=e=>{const t={};for(const r in e)if(Array.isArray(e[r])){const o=[];e[r].forEach((e=>{"object"==typeof e?o.push(n(e)):o.push(e)})),t[r]=o}else"object"!=typeof e[r]||e[r].tagName?t[r]=e[r]:t[r]=n(e[r]);return t},o=(e,t={},r=!0)=>{let n="";for(const e in t)n+=`const ${e} = ${"string"==typeof t[e]?'"'+t[e]+'"':JSON.stringify(t[e])}; `;try{const o=Function("ctx",`with(window.data) {${n}; return ${e};}`);return r?o(t):o}catch(e){return e.toString()}},s=[],i=new WeakMap,a=(e,t)=>{for(const r in e)"object"==typeof e[r]&&(e[r]=a(e[r],t));const r=new Proxy(e,{get(e,r,n){const o=Reflect.get(e,r,n);return t.onGet(e,r,n),o},set(e,r,n,o){"object"==typeof n&&(n=a(n,t));const s=Reflect.set(e,r,n,o);return t.onSet(e,r,n,o),s},deleteProperty(e,r){const n=Reflect.deleteProperty(e,r);return t.onDeleteProperty(e,r),n}});return Array.isArray(e)&&Object.setPrototypeOf(r,Array.prototype),r},c=(e,t)=>{if(!s.length)return;let r=i.get(e);r||(r=new Map,i.set(e,r));let n=r.get(t);n||(n=new Set,r.set(t,n)),s.forEach((e=>n.add(e)))},l=(e,t)=>{const r=i.get(e);if(!r)return;const n=r.get(t);n&&n.forEach((e=>{e()}))},d=e=>{s.push(e),e(),s.pop()},h=e=>a(e,{onGet(e,t){c(e,t)},onSet(e,t){l(e,t)},onDeleteProperty(){}}),u=e=>{const t={get value(){return c(t,"value"),e},set value(r){r!==e&&(e=r,l(t,"value"))}};return t},p=e=>{const t=u(null);return d((()=>t.value=e())),t},f=["t-if","t-elif"],g=["t-if","t-elif","t-else"],v=(e,t)=>{let r=!1;return d((()=>{const n=o(e.props.cond,t);r=!!n,e.props.rendered=r.toString()})),r},w=(e,t,r,n)=>{let s=!1;const i=r.children[r.children.length-1];return!(n-1==0||!f.includes(i.tag)||"true"===i.props.rendered)&&(d((()=>{const r=o(e.props.cond,t);s=!!r,e.props.rendered=s.toString()})),s)},m=(e,t,r,n)=>{let s=!1;const i=r.children[r.children.length-1];return!(n-1==0||!f.includes(i.tag))&&(d((()=>{const r=o(i.props.cond,t);s=!r,e.props.rendered=s.toString()})),s)},y={renderer:(e,t)=>{const r=e.props.data.split(" in "),n=r[0].trim(),s=o(r[1].trim(),t),i=e.el.children[0];e.children=[];for(const[r,o]of s.entries()){const s=W(i);R(s,s.el,Object.assign(Object.assign({},t),{[n]:o}));let a=!0;b.renderers.forEach((i=>{if(!i.shouldFire(s))return;const c=i.renderer(s,Object.assign(Object.assign({},t),{[n]:o}),e,r);a="boolean"!=typeof c?c.shouldRender?a:c.shouldRender:c?a:c})),a&&e.children.push(s)}return!1},name:"loopRenderer",shouldFire:e=>"t-for"===e.tag};var b={renderers:[{renderer:(e,t)=>(d((()=>{e.children=[o(e.props.data,t).toString()]})),!0),name:"variableRenderer",shouldFire:e=>"v"===e.tag},{renderer:(e,t,r,n)=>{let o=null;return o="t-if"===e.tag?v:"t-elif"===e.tag?w:m,o(e,t,r,n)},name:"conditionRenderer",shouldFire:e=>g.includes(e.tag)},y,{renderer:(e,t)=>{const r="/* TNT_RENDERED */",n="__tnt_",s={};for(const i in e.props){let a=i;if(a.startsWith(n)&&(a=a.slice(n.length)),a.startsWith(":")||a.startsWith("on"))if(a.startsWith("on")){if(e.props[i].startsWith(r))continue;const o=n+a;let c="";for(const e in t)c+=`const ${e} = ${JSON.stringify(t[e])}; `;const l=`${r} with (window.data) {${c}${e.props[o in e.props?o:a].toString()}}`;s[o]=e.props[i],e.el.setAttribute(a,l),e.props[a]=l}else i.startsWith(":on")&&console.warn("[TNT warn] Using reactive binding and event listeners at the same time will cause the program to run not as expected.","Please extract logic or remove one of the effect bindings."),e.el.removeAttribute(i),d((()=>{e.el.setAttribute(i.slice(1),o(e.props[i],t))}))}for(const t in s)e.el.setAttribute(t,s[t]),e.props[t]=s[t];return!0},name:"attributeRenderer",shouldFire(e){for(const t in e.props)if(t.startsWith(":")||t.startsWith("on"))return!0;return!1}},{renderer:(e,t)=>{let r;const n=e.props.src,o=e.props.type,s=e.props.data,i=new XMLHttpRequest;if(i.open("GET",n,!1),void 0===s?i.send(null):i.send(s),"text"===o){const t=i.responseText;e.children=[t.toString()]}else if("json"===o){const e=i.responseText;if(!e)return;const t=JSON.parse(e);r=h(t)}return r.requestData={text:i.responseText,code:i.status},{shouldRender:!0,injectVariables:r}},name:"getRenderer",shouldFire:e=>"t-get"===e.tag}]};const T=(e,t={},r,n)=>({tag:e,props:t,children:r,el:n}),E=(e,t,r={})=>{const n=e.el=document.createElement(e.tag);for(const t in e.props){const r=e.props[t];n.setAttribute(t,r)}return b.renderers.forEach((t=>{t.fireOnMounted&&t.shouldFire(e)&&t.renderer(e,r)})),"string"==typeof e.children?(n.textContent=e.children,void t.appendChild(n)):(e.children.forEach((e=>{"string"!=typeof e?E(e,n,r):n.appendChild(document.createTextNode(e))})),t.appendChild(n),t)},N=(e,t,r={})=>{if(e.tag===t.tag){const n=t.el=e.el,o=e.props||{},s=t.props||{};for(const e in s){const t=o[e],r=s[e];r!==t&&n.setAttribute(e,r)}for(const e in o)e in s||n.removeAttribute(e);const i=e.children,a=t.children,c=Math.min(i.length,a.length);for(let e=0;e<c;e++){const t=i[e],o=a[e];"string"!=typeof t||"string"!=typeof o?N(t,o,r):t!==o&&n.replaceChild(document.createTextNode(o),n.childNodes[e])}return a.length>i.length?void a.slice(i.length).forEach((e=>{"string"!=typeof e?E(e,n,r):n.appendChild(document.createTextNode(e))})):a.length<i.length?void i.slice(a.length).forEach(((e,t)=>{"string"!=typeof e?n.removeChild(e.el):n.removeChild(n.childNodes[t])})):void 0}throw new Error("Replacing root elements are not supported.")},j=e=>{const t={};for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r].value;t[e.attributes[r].name]=n}return t},R=(e,t,r={})=>{[...t.childNodes].forEach(((t,n)=>{if(t.nodeType===Node.TEXT_NODE){if(!t.textContent.trim())return;return void e.children.push(t.textContent)}if(t.nodeType!==Node.ELEMENT_NODE)return;let o=!0,s=r;const i=T(t.tagName.toLowerCase(),j(t),[]);i.el=t,b.renderers.forEach((t=>{if(!t.shouldFire(i))return;const r=t.renderer(i,s,e,n);"boolean"!=typeof r?(o=r.shouldRender||o,s=Object.assign(Object.assign({},s),r.injectVariables)):o=r?o:r})),o&&R(i,t,s),e.children.push(i)}))},W=e=>T(e.tagName.toLowerCase(),j(e),[],e);var M,x,A,C,O,S,k,P,$,D,F;return x=new WeakMap,A=new WeakMap,C=new WeakMap,O=new WeakMap,S=new WeakMap,k=new WeakMap,P=new WeakMap,$=new WeakMap,M=new WeakSet,D=function(){const e=(e,r,n)=>{Array.isArray(n)&&(e.reactive[r].splice(0,e.reactive[r].length),e.reactive[r].push(...n)),l(t(this,S,"f")[r],r)},r={get(e,t){if("symbol"!=typeof t)return(t=t.toString())in e.reactive?e.reactive[t]:t in e.computed?e.computed[t].value:t in e.ref?(c(e.ref[t],"value"),e.ref[t].value):void console.warn(`[TNT warn] You accessed a value not defined (Reading '${t}').`)},set:(t,r,n)=>r in t.reactive?(e(t,r,n),!0):r in t.ref?(t.ref[r].value=n,l(t.ref[r],"value"),!0):(console.warn(`[TNT warn] You set a value not defined (Reading '${r}').`),!1),has:(e,t)=>("symbol"==typeof t&&(t=t.toString()),!(t in globalThis)&&(t in e.ref||t in e.reactive||t in e.computed))};return new Proxy({reactive:t(this,x,"f"),computed:t(this,A,"f"),ref:t(this,C,"f")},r)},F=function(e,t){e.children.length>1&&t.remove()},e.TNTApp=class{constructor(){M.add(this),x.set(this,void 0),A.set(this,void 0),C.set(this,void 0),O.set(this,void 0),S.set(this,void 0),k.set(this,void 0),P.set(this,void 0),$.set(this,void 0),r(this,k,(()=>{}),"f"),r(this,P,[],"f"),r(this,A,{},"f"),r(this,x,{},"f"),r(this,C,{},"f"),r(this,$,[],"f"),r(this,S,{},"f"),window.data={}}mount(e){let r=!1,o=null,s=null;return t(this,P,"f").push("mount"),d((()=>{var i;const a=null!==(i=null==s?void 0:s.el)&&void 0!==i?i:e.children[0],c=T(a.tagName,j(a),[]);if(c.el=a,R(c,a,{}),s=T(e.tagName,j(a),c.children,a),!r)return o=n(s),E(o,e,{}),r=!0,t(this,M,"m",F).call(this,e,a),void t(this,k,"f").call(this,this);const l=n(s);N(o,l,{}),o=n(l),t(this,M,"m",F).call(this,e,a)})),this}get data(){return t(this,O,"f")}useData(e){t(this,P,"f").push("data"),r(this,S,n(e),"f"),r(this,x,{},"f"),r(this,C,{},"f");for(const r in e)"object"!=typeof e[r]?t(this,C,"f")[r]=u(e[r]):t(this,x,"f")[r]=h(e[r]);return r(this,O,t(this,M,"m",D).call(this),"f"),window.data=t(this,O,"f"),this}useComputed(e){t(this,P,"f").push("computed"),t(this,P,"f").includes("data")||console.warn("[TNT warn] useComputed() hook is called before useData(). Any reactive data accessed from computed functions will not be accessable.","This may lead to unpredictable results or errors.");for(const r in e)t(this,A,"f")[r]=p(e[r]);return r(this,O,t(this,M,"m",D).call(this),"f"),window.data=t(this,O,"f"),this}useEffect(e){return t(this,P,"f").push("effect"),t(this,$,"f").push(e),d(e),this}onMounted(e){return r(this,k,e,"f"),this}},e.computed=p,e.getTrackableObject=a,e.h=T,e.mount=E,e.patch=N,e.reactive=h,e.ref=u,e.targetMap=i,e.track=c,e.trigger=l,e.watchEffect=d,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=tnt.min.js.map
