import{__classPrivateFieldSet as t,__classPrivateFieldGet as e}from"../node_modules/tslib/tslib.es6.js";import{deepClone as i}from"./lib/common.js";import{watchEffect as s,trigger as a,track as o,reactive as n,ref as r,computed as f}from"./reactivity.js";export{computed,getTrackableObject,reactive,ref,targetMap,track,trigger,watchEffect}from"./reactivity.js";import{h as c,getAttributesOfElement as d,createVdomFromExistingElement as l,mount as u,patch as m}from"./vdom.js";export{h,mount,patch}from"./vdom.js";export{TNTPlugin}from"./plugin.js";var p,v,w,g,k,y,M,T,b,W,j,N,x,E,P,A,S,H,L;class R{constructor(){p.add(this),v.set(this,void 0),w.set(this,void 0),g.set(this,void 0),k.set(this,void 0),y.set(this,void 0),M.set(this,void 0),T.set(this,void 0),b.set(this,void 0),W.set(this,void 0),j.set(this,void 0),N.set(this,void 0),t(this,M,(()=>{}),"f"),t(this,T,(()=>{}),"f"),t(this,b,[],"f"),t(this,w,{},"f"),t(this,v,{},"f"),t(this,g,{},"f"),t(this,W,[],"f"),t(this,y,{},"f"),t(this,N,[],"f"),window.data={};const e=document.getElementsByTagName("page-id")[0];t(this,j,e.innerHTML,"f"),e.innerHTML=""}page(i,...s){s.includes(e(this,j,"f"))&&(void 0!==i.main&&(window.onload=i.main),void 0!==i.ready&&(()=>{t(this,T,i.ready,"f"),e(this,T,"f").call(this,this)})(),void 0!==i.data&&e(this,p,"m",A).call(this,i.data),void 0!==i.computed&&e(this,p,"m",S).call(this,i.computed),void 0!==i.effect&&e(this,p,"m",H).call(this,i.effect),void 0!==i.mounted&&(()=>{t(this,M,i.mounted,"f")})(),void 0!==i.mount&&e(this,p,"m",E).call(this,i.mount))}useExportPlugin(t){e(this,N,"f").push(t)}get data(){return e(this,k,"f")}usePlugin(t){return e(this,N,"f").push(t),this}}v=new WeakMap,w=new WeakMap,g=new WeakMap,k=new WeakMap,y=new WeakMap,M=new WeakMap,T=new WeakMap,b=new WeakMap,W=new WeakMap,j=new WeakMap,N=new WeakMap,p=new WeakSet,x=function(t){const e=t.methods();for(const t in e)this[t]=e[t];t.onload()},E=function(t){let a=!1,o=null,n=null;return e(this,b,"f").push("mount"),s((()=>{var s;const h=null!==(s=null==n?void 0:n.el)&&void 0!==s?s:t.children[0],r=c(h.tagName,d(h),[]);if(r.el=h,l(r,h,{}),n=c(t.tagName,d(h),r.children,h),!a)return o=i(n),u(o,t,{}),a=!0,e(this,p,"m",L).call(this,t,h),void e(this,M,"f").call(this,this);const f=i(n);m(o,f,{}),o=i(f),e(this,p,"m",L).call(this,t,h)})),e(this,N,"f").forEach((t=>{e(this,p,"m",x).call(this,t)})),this},P=function(){const t=(t,i,s)=>{Array.isArray(s)&&(t.reactive[i].splice(0,t.reactive[i].length),t.reactive[i].push(...s)),a(e(this,y,"f")[i],i)},i={get(t,e){if("symbol"!=typeof e)return(e=e.toString())in t.reactive?t.reactive[e]:e in t.computed?t.computed[e].value:e in t.ref?(o(t.ref[e],"value"),t.ref[e].value):void console.warn(`[TNT warn] You accessed a value not defined (Reading '${e}').`)},set:(e,i,s)=>i in e.reactive?(t(e,i,s),!0):i in e.ref?(e.ref[i].value=s,a(e.ref[i],"value"),!0):(console.warn(`[TNT warn] You set a value not defined (Reading '${i}').`),!1),has:(t,e)=>("symbol"==typeof e&&(e=e.toString()),!(e in globalThis)&&(e in t.ref||e in t.reactive||e in t.computed))};return new Proxy({reactive:e(this,v,"f"),computed:e(this,w,"f"),ref:e(this,g,"f")},i)},A=function(s){e(this,b,"f").push("data"),t(this,y,i(s),"f"),t(this,v,{},"f"),t(this,g,{},"f");for(const t in s)"object"!=typeof s[t]?e(this,g,"f")[t]=r(s[t]):e(this,v,"f")[t]=n(s[t]);return t(this,k,e(this,p,"m",P).call(this),"f"),window.data=e(this,k,"f"),this},S=function(i){e(this,b,"f").push("computed"),e(this,b,"f").includes("data")||console.warn("[TNT warn] useComputed() hook is called before useData(). Any reactive data accessed from computed functions will not be accessable.","This may lead to unpredictable results or errors.");for(const t in i)e(this,w,"f")[t]=f(i[t]);return t(this,k,e(this,p,"m",P).call(this),"f"),window.data=e(this,k,"f"),this},H=function(t){return e(this,b,"f").push("effect"),e(this,W,"f").push(t),s(t),this},L=function(t,e){t.children.length>1&&e.remove()};export{R as TNTApp};
//# sourceMappingURL=index.js.map
